var e=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequiref23a;(0,e.register)("kYRgI",function(t,r){Object.defineProperty(t.exports,"FileHandle",{get:function(){return d},set:void 0,enumerable:!0,configurable:!0});var s=e("cFLn4");let{WritableStream:a,TransformStream:n,DOMException:o,Blob:i}=e("a2zud").default,{GONE:l}=s.errors,c=/constructor/i.test(window.HTMLElement);class d{constructor(e="unkown"){this.name=e,this.kind="file"}async getFile(){throw new o(...l)}async isSameEntry(e){return this===e}async createWritable(e={}){let t=await navigator.serviceWorker?.getRegistration(),r=document.createElement("a"),s=new n,o=s.writable;if(r.download=this.name,c||!t){let e=[];s.readable.pipeTo(new a({write(t){e.push(new i([t]))},close(){let t=new i(e,{type:"application/octet-stream; charset=utf-8"});e=[],r.href=URL.createObjectURL(t),r.click(),setTimeout(()=>URL.revokeObjectURL(r.href),1e4)}}))}else{let{writable:r,readablePort:o}=new p(a),i=encodeURIComponent(this.name).replace(/['()]/g,escape).replace(/\*/g,"%2A"),l={"content-disposition":"attachment; filename*=UTF-8''"+i,"content-type":"application/octet-stream; charset=utf-8",...e.size?{"content-length":e.size}:{}},c=setTimeout(()=>t.active.postMessage(0),1e4);s.readable.pipeThrough(new n({transform(e,t){if(e instanceof Uint8Array)return t.enqueue(e);let r=new Response(e).body.getReader(),s=e=>r.read().then(e=>e.done?0:s(t.enqueue(e.value)));return s()}})).pipeTo(r).finally(()=>{clearInterval(c)}),t.active.postMessage({url:t.scope+i,headers:l,readablePort:o},[o]);let d=document.createElement("iframe");d.hidden=!0,d.src=t.scope+i,document.body.appendChild(d)}return o.getWriter()}}class h{constructor(e){e.onmessage=e=>this._onMessage(e.data),this._port=e,this._resetReady()}start(e){return this._controller=e,this._readyPromise}write(e){return this._port.postMessage({type:0,chunk:e},[e.buffer]),this._resetReady(),this._readyPromise}close(){this._port.postMessage({type:2}),this._port.close()}abort(e){this._port.postMessage({type:1,reason:e}),this._port.close()}_onMessage(e){0===e.type&&this._resolveReady(),1===e.type&&this._onError(e.reason)}_onError(e){this._controller.error(e),this._rejectReady(e),this._port.close()}_resetReady(){this._readyPromise=new Promise((e,t)=>{this._readyResolve=e,this._readyReject=t}),this._readyPending=!0}_resolveReady(){this._readyResolve(),this._readyPending=!1}_rejectReady(e){this._readyPending||this._resetReady(),this._readyPromise.catch(()=>{}),this._readyReject(e),this._readyPending=!1}}class p{constructor(e){let t=new MessageChannel;this.readablePort=t.port1,this.writable=new e(new h(t.port2))}}});
//# sourceMappingURL=downloader.47d76417.js.map
